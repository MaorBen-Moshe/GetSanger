<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:GetSanger.ViewModels"
             x:Class="GetSanger.Views.Registration.RegistrationPage"
             xmlns:Converters="clr-namespace:GetSanger.Converters"
             NavigationPage.HasNavigationBar="False">

    <ContentPage.BindingContext>
        <vm:LoginViewModel />
    </ContentPage.BindingContext>

    <ContentPage.Resources>
        <Converters:EntryLengthToBoolConverter x:Key="EntryLengthToBoolConverter"/>
    </ContentPage.Resources>

    <Grid>
        <StackLayout  VerticalOptions="Center" 
                      Padding="5, 0, 5, 0" 
                      Grid.Row="0" 
                      Grid.RowSpan="2" 
                      Margin="0, 10, 0, 0">
            <Label Text="Get Sanger" 
                   FontSize="30"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="Black" />
            <Label Text="Be the best Sanger you can !"
                   FontSize="18"
                   HorizontalOptions="Center" />
            <Label Text="Treat the sangers well!" 
                   FontSize="14"
                   HorizontalOptions="Center" />
            <Frame BorderColor="Transparent">
                <StackLayout>
                    <Entry Keyboard="Email" 
                           Placeholder="Email" 
                           Text="{Binding Email, Mode=TwoWay}" x:Name ="EmailEntry" />
                    <Entry IsPassword="True" 
                           Placeholder="Password" 
                           Text="{Binding Password, Mode=TwoWay}" x:Name = "PasswordEntry" />
                    <Grid>
                        <Button Text="Forgot password?"  
                                HorizontalOptions="EndAndExpand" 
                                Grid.Column="1" 
                                BackgroundColor="Transparent" 
                                TextTransform="None" 
                                Command="{Binding ForgotPasswordCommand}"
                                CommandParameter="{Binding Email}"/>
                    </Grid>
                </StackLayout>
            </Frame>

            <Button Text="Login" 
                    Command="{Binding LoginCommand}" IsEnabled="{Binding IsEnabledsendBtn}">
                <Button.Triggers>
                    <MultiTrigger TargetType="Button">
                        <MultiTrigger.Conditions>
                            
                            <BindingCondition Binding="{Binding Source = {x:Reference EmailEntry}, 
                                Path = Text.Length, Converter={StaticResource EntryLengthToBoolConverter}}" Value="True"/>

                            <BindingCondition Binding="{Binding Source = {x:Reference PasswordEntry}, 
                                Path = Text.Length, Converter={StaticResource EntryLengthToBoolConverter}}" Value="True"/>

                        </MultiTrigger.Conditions>
                        <Setter Property="IsEnabled" Value="True"/>
                    </MultiTrigger>
                </Button.Triggers>
                
            </Button>
            <BoxView HeightRequest="1" 
                     Color="Gray" 
                     IsVisible="true" />
            
        </StackLayout>
        <Grid Grid.Row="2">
            <Button Text="Via Facebook"
                        Command="{Binding SocialLoginCommand}"
                        CommandParameter="Facebook"
                        Grid.Row="0" 
                        Grid.Column="0" />
            <Button Text="Via Google" 
                        Command="{Binding SocialLoginCommand}"
                        CommandParameter="Google"
                        Grid.Row="0" 
                        Grid.Column="1"/>
            <Button Text="Via Apple" 
                        Command="{Binding SocialLoginCommand}"
                        CommandParameter="Apple"
                        Grid.Row="0" 
                        Grid.Column="2"/>
        </Grid>

        <StackLayout VerticalOptions="EndAndExpand" 
                     Padding="5" 
                     Grid.Row="3">
            <Button Text="Sign up" 
                    VerticalOptions="EndAndExpand"
                    Command="{Binding SignUpCommand}"/>
        </StackLayout>
    </Grid>
</ContentPage>